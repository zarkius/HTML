<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Cliente WebSocket</title>
  </head>
  <body>
    <h1>Bienvenido al Cliente WebSocket</h1>
    <div>
      <label for="message">Mensaje:</label>
      <input type="text" id="message" name="message" />
      <button onclick="sendMessage()">Enviar</button>
    </div>
    <div id="response"></div>

    <script>
      const socket = new WebSocket("wss://chat.yposteriormente.com/");

      socket.onopen = function (event) {
        console.log("Conexión WebSocket establecida.");
      };

      socket.onmessage = function (event) {
        const responseDiv = document.getElementById("response");
        responseDiv.innerHTML += `<p>Respuesta: ${event.data}</p>`;
      };

      socket.onclose = function (event) {
        console.log("Conexión WebSocket cerrada.");
      };

      socket.onerror = function (event) {
        console.error("Error en WebSocket:", event);
        const errorDiv = document.getElementById("error");
        errorDiv.innerHTML = `Error en WebSocket: ${
          event.message || "Verifica el lado del servidor"
        }; Código: ${event.code || "N/A"}`;
      };

      function sendMessage() {
        const messageInput = document.getElementById("message");
        const message = messageInput.value;

        if (socket.readyState === WebSocket.OPEN) {
          socket.send(message);
        } else {
          console.log(
            "No se puede enviar el mensaje. La conexión WebSocket no está abierta."
          );
          const errorDiv = document.getElementById("error");
          errorDiv.innerHTML += `<p>No se puede enviar el mensaje. La conexión WebSocket no está abierta.</p>`;
        }
      }
    </script>
  </body>
</html>
